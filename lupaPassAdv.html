<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SignUp Register Page - Pesona Lokal</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="path/to/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="./css/login.css" />
  </head>

  <body>
    <div class="wrapper">
      <div class="text-center">
        <a href="home.html"
          ><img src="./assets/Header_Pesona Lokal.png" alt=""
        /></a>
      </div>
      <div class="title-text">
        <!-- <div class="title signup">Form Registrasi</div> -->
      </div>
      <div class="form-container">
        <h3
          class="text-center mt-4"
          style="color: rgba(102, 102, 102, 0.959); font-weight: 600"
        >
          Lupa Kata Sandi
        </h3>
        <div class="form-inner">
          <form id="lupaPassAdv" action="LupaSandi.php" method="POST" class="login">
            <pre></pre>
            <div id="loginAlertContainer"></div>
            <div class="field">
                <input type="password" name="password" id="password" placeholder="Masukan Password Baru" required>
              </div>
              <div class="field">
                <input type="password" id="confirm_password" name="confirm_password" placeholder="Ulangi password" required><br>
            <p style="color: rgba(102, 102, 102, 0.959); font-weight: 500; padding-top: 30px;margin-left: 10px; margin-bottom: -10px;">Masukan Kode Verifikasi</p>
            </div><br><br>
            <div
              id="otp"
              class="inputs d-flex flex-row justify-content-center mt-2"
            >
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="first"
                maxlength="1" required
              />
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="second"
                maxlength="1" required
              />
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="third"
                maxlength="1" required
              />
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="fourth"
                maxlength="1" required
              />
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="fifth"
                maxlength="1" required
              />
              <input
                class="m-2 text-center form-control rounded"
                type="text"
                id="sixth"
                maxlength="1" required
              />
            </div>
            <div class="field btn">
              <div class="btn-layer"></div>
              <input type="submit" value="Reset" />
            </div>
            <div class="pass-link mt-4 text-center">
              <a href="loginSignUp.html">Masuk Ke Akun</a>
            </div>
          </form>

          <p id="error_message" style="color: red"></p>
        </div>
      </div>
    </div>
    <script>
      document
        .getElementById("loginform")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Mencegah pengiriman form secara default
          loginUser();
        });

      document
        .getElementById("registerForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Mencegah pengiriman form secara default
          registerUser();
        });
      //dinggo login
      function loginUser() {
        var form = document.getElementById("loginform");
        var formData = new FormData(form);

        var loginAlertContainer = document.getElementById(
          "loginAlertContainer"
        );
        loginAlertContainer.innerHTML = ""; // Menghapus semua alert login sebelumnya

        var xhr = new XMLHttpRequest();
        xhr.open("POST", "login.php", true);
        xhr.onload = function () {
          if (xhr.status === 200) {
            var response = xhr.responseText.trim();
            if (response === "Login berhasil!") {
              window.location.href = "home-login.html"; // Mengarahkan ke halaman selanjutnya
            } else {
              showAlert(
                "danger",
                "Login gagal. " + response,
                loginAlertContainer
              );
            }
          } else {
            showAlert(
              "danger",
              "Terjadi kesalahan. Silakan coba lagi.",
              loginAlertContainer
            );
          }
        };
        xhr.send(formData);
      }

      //fungsi dinggo register
      function registerUser() {
        var form = document.getElementById("registerForm");
        var formData = new FormData(form);

        var registerAlertContainer = document.getElementById(
          "registerAlertContainer"
        );
        registerAlertContainer.innerHTML = ""; // Menghapus semua alert registrasi sebelumnya

        var xhr = new XMLHttpRequest();
        xhr.open("POST", "register.php", true);
        xhr.onload = function () {
          if (xhr.status === 200) {
            var response = xhr.responseText.trim();
            if (response === "Registrasi berhasil!") {
              window.location.href = "loginSignUp.html"; // Mengarahkan ke halaman selanjutnya
            } else {
              showAlert(
                "danger",
                "Registrasi gagal. " + response,
                registerAlertContainer
              );
            }
          } else {
            showAlert(
              "danger",
              "Terjadi kesalahan. Silakan coba lagi.",
              registerAlertContainer
            );
          }
        };
        xhr.send(formData);
      }
      //dinggo nampilke pesan eror
      function showAlert(type, message, container) {
        // membuat  elemen Alert Bootstrap
        var alertElement = document.createElement("div");
        alertElement.classList.add(
          "alert",
          "alert-" + type,
          "alert-dismissible",
          "fade",
          "show"
        );
        alertElement.setAttribute("role", "alert");

        // Tambahkan pesan dan tombol close ke dalam elemen Alert
        alertElement.innerHTML =
          "<strong>" +
          message +
          "</strong>" +
          '<button type="button" class="close" data-dismiss="alert" aria-label="Close">' +
          '<span aria-hidden="true">&times;</span>' +
          "</button>";

        // Tambahkan elemen Alert ke dalam container
        container.appendChild(alertElement);
      }
    </script>
    <script src="./js/login.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
  </body>
</html>
